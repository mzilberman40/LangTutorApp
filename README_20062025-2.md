# Langs2Brain API - Документация проекта

## 1. Обзор

Этот документ описывает архитектуру, ключевые концепции и руководство по использованию API для проекта **Langs2Brain**. Langs2Brain — это бэкенд-сервис для приложения по изучению языков, сфокусированный на создании и ведении персонализированных пользовательских словарей.

Ключевой принцип системы — максимальная автоматизация рутинных задач (поиск вариантов слов, перевод, проверка качества) с помощью LLM, вынесенная в асинхронные фоновые процессы.

## 2. Технологический стек

* **Бэкенд:** Python, Django, Django REST Framework
* **Асинхронные задачи:** Celery, Redis
* **База данных:** SQLite (для разработки), PostgreSQL (для продакшена)
* **Контейнеризация:** Docker, Docker Compose
* **Документация API:** `drf-spectacular` для генерации схемы OpenAPI 3.0

## 3. Запуск проекта локально

1.  Убедитесь, что у вас установлен Docker и Docker Compose.
2.  Создайте файл `.env` в корневой директории на основе `example.env` и укажите в нем необходимые ключи API (`NEBIUS_API_KEY`).
3.  Выполните команду для сборки и запуска контейнеров:
    ```bash
    docker compose up --build
    ```
4.  Для выполнения команд управления Django (например, миграций) используйте `docker compose exec`:
    ```bash
    # Создание миграций
    docker compose exec web python manage.py makemigrations

    # Применение миграций
    docker compose exec web python manage.py migrate
    ```

## 4. Доступ к API и документации

После запуска проекта, следующие эндпоинты будут доступны:

* **API:** `http://127.0.0.1:8000/api/`
* **Swagger UI (интерактивная документация):** `http://127.0.0.1:8000/api/docs/`
* **Redoc (альтернативная документация):** `http://127.0.0.1:8000/api/redoc/`
* **Админ-панель Django:** `http://127.0.0.1:8000/admin/`

## 5. Ключевые концепции API

### Асинхронная архитектура
Все операции, требующие значительного времени (обращения к LLM), являются асинхронными. API немедленно отвечает статусом `202 Accepted` и возвращает `task_id`. Результат выполнения задачи можно отслеживать через эндпоинт `GET /api/task-status/{task_id}/`.

### Валидация данных
Система использует многоуровневую валидацию:
1.  **На уровне API:** Сериализаторы проверяют типы данных и соответствие формату (например, валидность кода языка).
2.  **На уровне логики:** Каждая созданная или измененная сущность (`LexicalUnit`, `LexicalUnitTranslation`) проходит асинхронную фоновую проверку через LLM на лингвистическую корректность.

### Модель данных: `LexicalCategory` vs `PartOfSpeech`
Для точного представления словарных единиц, система четко разделяет их **структурный тип** и **грамматическую функцию**.

* `lexical_category`: Описывает структуру единицы. Основные значения:
    * `SINGLE_WORD`: Одно слово (e.g., "apple").
    * `PHRASAL_VERB`: Фразовый глагол (e.g., "take off").
    * `IDIOM`: Идиома (e.g., "kick the bucket").
    * `COLLOCATION`: Устойчивое словосочетание (e.g., "strong coffee").
* `part_of_speech`: Классическая часть речи (`noun`, `verb`, `adjective` и т.д.). Для составных единиц (идиом, фразовых глаголов) это поле хранит доминантную часть речи всего выражения.

### Основные сущности
* **LexicalUnit**: Атомарная словарная единица, принадлежащая пользователю. Определяется уникальной комбинацией `lemma`, `language`, `lexical_category` и `part_of_speech`.
* **LexicalUnitTranslation**: Связь между двумя `LexicalUnit`, представляющая перевод.
* **Phrase**: Фраза-пример, иллюстрирующая использование `LexicalUnit`.

Для детального описания всех полей и эндпоинтов обращайтесь к интерактивной документации Swagger.